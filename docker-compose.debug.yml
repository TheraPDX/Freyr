version: '2'
services:
  nginx:
    image: nginx:alpine
    volumes:
      - ./nginx/conf:/etc/nginx/
      - ./nginx/static:/usr/share/nginx/html
    ports:
      - "8080:80"
      - "8443:443"
    links:
      - gardenspark
  gardenspark:
    restart: always
    image: golang
    volumes:
      - $GOPATH/src/:/go/src/
      - ./:/go/src/github.com/serdmanczyk/gardenspark/
    working_dir: /go/src/github.com/serdmanczyk/gardenspark/
    command: go run main.go
    env_file: .env
    links:
      - gspkpostgres
  gspkpostgres:
    restart: always
    image: postgres:9.4
    volumes:
      - ./postgres/:/docker-entrypoint-initdb.d/
    env_file: ./postgres/.env
